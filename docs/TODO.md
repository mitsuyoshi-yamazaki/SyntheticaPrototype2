# TODO / 実装状況

## このファイルについて

- このファイルには本アプリケーション開発を進めるうえで行うタスクの状態一覧を格納する
- アーキテクチャドキュメント（architecture.md）の実装優先順位に基づいて構成

## タスクの状態

- （なし）未着手
- 🏃‍♀️ 進行中
- ✅ 完了済み
- 🚫 中止
- 😀 人間が行うタスク

---

## フェーズ1: 基盤 (必須)

### 数学・ユーティリティ
- ✅ Vec2ベクトル演算実装
- ✅ Vec2テスト作成
- ✅ トーラス数学実装（wrapPosition, shortestVector等）
- ✅ トーラス数学テスト作成
- ✅ オブジェクトプール実装のテスト作成

### ゲームループ基盤
- ✅ GameLoopController実装（一時停止/再開、FPS管理）
- GameLoopControllerテスト作成
- ✅ WorldStateManager実装（tick管理、オブジェクト管理）
- WorldStateManagerテスト作成

### オブジェクトシステム
- ✅ GameObject型定義（円形オブジェクト統一インターフェース）
- ✅ ObjectFactory実装（各種オブジェクト生成）
- ObjectFactoryテスト作成
- ObjectIdの生成とユニーク性保証のテスト

---

## フェーズ2: 物理とエネルギー (必須)

### 物理エンジン
- 空間ハッシュグリッド実装（SpatialHashGrid）
- 空間ハッシュグリッドテスト作成
- 衝突検出システム実装（円形オブジェクト専用）
- 衝突検出テスト作成
- 反発力計算実装（tanh関数による制限）
- 反発力計算テスト作成
- 物理演算統合（位置・速度更新）
- 物理演算統合テスト作成

### エネルギーシステム
- ✅ EnergyObject実装（エネルギーオブジェクトの定義）
- EnergyObjectテスト作成
- エネルギーオブジェクトの生成・結合ロジック実装
- エネルギー結合テスト作成
- ✅ エネルギーソース実装（10-100E/tick生成）
- エネルギーソーステスト作成
- エネルギー収集ロジック実装（HULLによる収集）
- エネルギー収集テスト作成

### 熱システム
- 熱拡散セルオートマトン実装
- 熱拡散テスト作成
- ノイマン近傍での熱流計算実装
- 熱流計算テスト作成
- 熱放射システム実装
- 熱放射テスト作成

### 方向性力場
- DirectionalForceField型定義
- 力場システム実装（LINEAR, RADIAL, SPIRAL）
- 力場システムテスト作成

---

## フェーズ3: ユニットシステム (必須)

### 基本ユニット
- ✅ Unit基本インターフェース定義
- ✅ HULL実装（コンテナユニット、エネルギー格納）
- HULLテスト作成
- ✅ ASSEMBLER実装（構築ユニット）
- ASSEMBLERテスト作成
- ✅ COMPUTER実装（演算ユニット基本構造）
- COMPUTERテスト作成

### ユニット動作
- HULLのエネルギー管理ロジック実装
- エネルギー管理テスト作成
- ASSEMBLERの構築ロジック実装（コスト計算、進捗管理）
- 構築ロジックテスト作成
- ユニット間の回路接続実装
- 回路接続テスト作成

---

## フェーズ4: Synthetica Script VM (必須)

### VMコア
- VMState実装（レジスタ、メモリ、プログラムカウンタ）
- VMStateテスト作成
- 命令デコーダ実装
- 命令デコーダテスト作成
- 命令実行エンジン実装
- 命令実行テスト作成

### 基本命令セット
- 基本演算命令実装（ADD, SUB, MUL, DIV, MOD）
- 基本演算命令テスト作成
- ビット操作命令実装（AND, OR, XOR, NOT, SHL, SHR）
- ビット操作命令テスト作成
- 制御フロー命令実装（JMP, JZ, JNZ, JG, JL）
- 制御フロー命令テスト作成
- メモリ操作命令実装（LOAD, STORE, LOADR, STORER）
- メモリ操作命令テスト作成

### スタック操作命令
- スタック管理実装（スタックポインタ、オーバーフロー検出）
- スタック操作命令実装（PUSH, POP, DUP, SWAP）
- スタック操作命令テスト作成

### ユニット制御命令
- SCAN命令実装（自身のスペック読み取り）
- SCAN命令テスト作成
- SCANM命令実装（メモリ複数読み取り）
- SCANM命令テスト作成
- ASSEMBLE命令実装（ユニット構築）
- ASSEMBLE命令テスト作成
- エネルギー操作命令実装（ENERGY関連）
- エネルギー操作命令テスト作成

### VM統合
- COMPUTERユニットへのVM統合
- VM実行サイクル管理（処理能力に応じた実行）
- VMエラーハンドリング実装
- VM統合テスト作成

---

## フェーズ5: レンダリングシステム (必須)

### PixiJS基盤
- ✅ PixiJSレンダラー初期化
- ✅ GameCanvasPixiコンポーネント実装
- カスタムViewport実装（パン・ズーム機能）
- Viewportテスト作成

### 描画実装
- ✅ ゲームオブジェクト描画（円形、色分け）
- ✅ エネルギーソース描画
- ユニット種別ごとの視覚表現実装
- 熱マップオーバーレイ実装
- 力場可視化実装

### 最適化
- 可視範囲カリング実装
- LODシステム実装（遠距離オブジェクトの簡略表示）
- バッチレンダリング最適化
- 描画パフォーマンステスト作成

---

## フェーズ6: UI実装 (必須)

### 基本UI
- 一時停止/再開ボタン実装
- シミュレーション速度調整スライダー実装
- FPS/統計情報表示実装
- ズーム/パンコントロール実装

### パラメータエディタ
- WorldParametersエディタUI実装
- リアルタイムパラメータ反映実装
- パラメータプリセット機能実装
- パラメータ保存/読み込み機能

### デバッグツール
- オブジェクトインスペクター実装（クリックで詳細表示）
- VMステートビューア実装（COMPUTER内部状態表示）
- パフォーマンスモニター実装
- 空間ハッシュグリッド可視化

---

## フェーズ7: エージェント実装 (必須)

### サンプルエージェント
- 静止エージェント実装（エネルギー収集のみ）
- 自己修復エージェント実装
- ✅ 基本的なエージェント定義（AgentDefinition）
- v3.0.0準拠の自己複製エージェント実装
- v3.1.0準拠の自己複製エージェント実装（プリミティブ命令使用）

### エージェントローダー
- エージェント定義のバリデーション実装
- 初期配置ロジック実装
- 複数エージェント同時投入機能

---

## フェーズ8: 統合・最適化 (オプション)

### パフォーマンス最適化
- 10,000オブジェクト時のパフォーマンステスト
- メモリ使用量プロファイリング
- 計算ボトルネック特定と最適化
- WebWorker導入検討

### 品質保証
- E2Eテスト実装
- 統合テストスイート拡充
- エラーハンドリング強化
- ログシステム実装

---

## その他のタスク

### ドキュメント
- 😀 APIドキュメント作成
- 😀 エージェント作成ガイド作成
- 😀 Synthetica Script言語リファレンス作成

### インフラ
- ✅ Vercelデプロイ設定
- ✅ GitHub Actions CI設定
- 😀 パフォーマンスベンチマーク環境構築

---

## 完了済みタスク（アーカイブ）

- ✅ Next.js + TypeScript + Tailwind CSSの基本セットアップ
- ✅ p5.jsインスタンスモード統合
- ✅ GameWorldクラス基本実装
- ✅ GameCanvasコンポーネント（ゲームループ付き）
- ✅ Jest + ESLint + Prettierによるテスト・品質管理環境
- ✅ 静的エクスポート設定
- ✅ GitHub Actions CIパイプライン設定
- ✅ コミットワークフローとコミットノート機能
- ✅ GitHub Issue/PR作成時のAI識別機能
- ✅ 実装アーキテクチャ設計
- ✅ 描画ライブラリ選定（p5.js→PixiJS）
- ✅ ゲームエンジンコア実装