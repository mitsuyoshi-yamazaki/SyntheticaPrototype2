## このファイルについて

- 本ファイルはゲームの要件と仕様について記載している
- **本ファイルは記載途中である**

## Claudeへの指示

- ゲームの要件と仕様を更新した際は本ファイルの内容も追従させること

## ゲーム要件

- このゲームは、プレイヤーが作成したエージェントを環境中に放って自律行動するのを観察するMMOゲームである
  - このゲームの目的は、オープンエンドな進化を、①十分に一貫した自由度の高いシミュレーション系のうえで、②人間に競争させることでオープンエンド性を付与する ことで実現するものである（※ 人間が競争する際に発揮する創造性はオープンエンドであるという仮定のもと進める）
- エージェントは全て自律的に動作し、環境中の資源を回収・代謝して自己を拡張・修復・複製する
- エージェントの身体は資源回収、移動、アセンブリ、情報処理など複数の種類のユニットを組み合わせて成り立つ
- プレイヤーはこのエージェントの身体部分を定義するとともに、頭脳ユニットで実行するソフトウェアを作成することでエージェントを作成する
- このような仕様のシミュレーションにより、地球上に存在するものも存在しないものも含めて、任意の生態を持つエージェントを作成・繁殖できる場を提供することを目的とする

## ゲーム仕様

### 世界

- 世界は上下左右がループした二次元トーラス形状をとる
- ゲームの時間は離散的である。各tickにゲームオブジェクト物理演算とユニットの動作処理が行われ、その結果が次tickに反映される

### ゲームオブジェクト

- ゲーム世界上に存在する物体のことをゲームオブジェクトと呼称する
- ゲームオブジェクトは以下のプロパティをもつ
  - 位置
    - 位置は（離散的なグリッド上に置かれるのではなく）連続的数値で表される
  - 大きさ、形状
  - 速度
    - 速度は前tickにそのゲームオブジェクトに加わった加速度により増減する
  - 重量
    - 重量はゲームオブジェクトにかかった力がどれだけの加速度を生むかに影響する
  - 構成物質
- 仕様
  - 衝突
    - 複数のゲームオブジェクトが同時に同じ空間の一点に存在することは禁止したいが、計算処理を容易にするため、完全に禁止はせずに以下の仕様で実装する
      - 重なった複数の物体は共通重心から離れる方向へ力を受ける（ことにより、物体の重なりを時間経過で解消する）
  - 隣接
    - ふたつのオブジェクトが"隣接"している状態とは以下のどれかの状態である
      - 双方がユニットであり、接続している状態
      - ふたつのオブジェクトが"隣接距離"以下の間隔で隣り合っている状態
        - 両方がHULLの中にいる場合は常に隣接状態
        - HULLとそのHULLの内容物は常に隣接状態

### 資源

- 資源はゲームオブジェクトである
- 原則：世界に存在する資源の総量は常に一定である（質量の保存）
  - 細則：ある物体を構成、分解しても、資源の総量は変わらない
  - 例外：
    - プレイヤーが新たなエージェントを世界に投入する際には、そのエージェントの構成物質分の資源が世界に追加される。この問題は将来的には解消させる
    - 後述のエネルギー
- 資源は粒子の形状をとる
- 資源の量は0以上の整数であり、小数をとらない
- 種別
  - 資源の種類は以下の4種類である
    - mineral
    - organic
    - chemical
    - energy（後述のエネルギー）

#### エネルギー

- エネルギーは資源の一種である
- エネルギーはエネルギーソースから、ソースごとに定められたエネルギー算出量に応じて、毎tick生成される
- 資源の分解や合成、エージェントの移動やCOMPUTERの計算処理など、全ての活動はエネルギーを消費する。消費されたエネルギーは消滅する

#### 物質

- 資源が合成されて生成される物質には以下の3種類がある
  - ユニット（後述）
  - ユニット断片
    - 破壊され、機能を失ったユニット。マテリアルと同じ（ゲーム演出上の見た目のみが異なる）
  - マテリアル
    - 1種類以上の資源が、物理現象もしくはASSEMBLERにより合成されて生成された物体
    - マテリアルから資源を回収するには、物理現象により分解されたところを利用するか、DISASSEMBLERにより分解する必要がある

#### 物質の合成と分解

- TBD: 合成と分解の条件を記載する

### エージェント

- 「エージェント」とは、相互に結合したユニットの集まりを、人間のために便宜上そう呼んでいるだけであり、ゲームの実装上そのような単位の実装が存在するわけではない
  - ゲーム世界上では、それぞれのユニットが自律して動作し、周囲のユニットや環境と相互作用を行っているだけである

### ユニット

- ユニットはゲームオブジェクトである
- 仕様：
  - ユニット生成時に固定される性質と、生成後に再設定可能な性質がある
  - ユニット生成
    - 全てのユニットはASSEMBLERにより、そのユニットを構成するのに必要な資源と、エネルギーを使って構築される
    - ユニット構築に必要な資源とエネルギーの量は、ユニットの種別ごとに異なる。また、同じユニットでも、異なる資源配分で構築されたものは異なるパラメータを持つ
      - この仕様は「生産仕様」の項に定義される
      - あるユニットの生産に必要な資源の量は、それぞれの資源の頭文字 + 資源量で M1O2C3E4 （Mineral:1, Organic:2, Chemical:3, Energy:4）のように表す
  - ユニット分解
    - ユニットはDISASSEMBLERに分解される、または環境ダメージにより構成資源を剥ぎ取られることでダメージを負う
      - 軽微なダメージはASSEMBLERにより、失った資源とエネルギーを費やすことで修復が可能である
      - 一定以上の構成要素を失ったユニットはユニットとしての機能を喪失し、"分解された"状態となる
      - ユニットが分解されると資源へと変化する。このとき、資源の総量は分解前のユニットの構成資源量と変わらない
    - あるユニットがどのように分解されるかは「分解仕様」の項に定義される
  - ユニットはゲームオブジェクトに直接作用しない、ソフトウェアの実行に関わる回路としての性質をもつ（回路仕様）
- 回路仕様：
  - 回路的に接続しているユニットへはソフトウェアから情報アクセス・指令ができる（物理的に接続していても回路的には接続していない状態もある）
  - COMPUTERが実行するソフトウェアから特定のユニットへアクセスするためのラベルをつけられる
  - ユニットは、回路で接続しているCOMPUTERからアクセスするためのAPIをもつ
  - 基本的な構想として、ユニットが何かの行動を起こそうとして失敗する場合、ソフトウェア的なエラーを返すのではなく、実行はするが意図した結果が得られない、という現象として実現する
- ユニットには以下の種別がある
  - HULL
  - ASSEMBLER
  - DISASSEMBLER
  - CONNECTOR
  - CHANNEL
  - COMPUTER
  - SENSOR
  - MOVER

#### HULL

- 概要：
  - ゲーム世界の一角を区切ることで、エージェントの身体を形作る。エージェントを細胞に例えるとHULLは細胞膜である
- 仕様：
  - HULLは容量をもち、他のユニットや資源を格納できる
  - HULLの中身は広さのない空間（内容物全てが"隣接"しており、HULLに対する相対速度は常に0の状態）である
    - この性質により、HULLの内部に配置されたASSEMBLERやDISASSEMBLERはHULLとHULLの内部に格納されたユニット全てに対して操作が可能である
    - ゲーム的な観点から、見た目上は広さがあり、それぞれの内容物が重ならずに存在している見た目（細胞の模式図のような）をとる
  - HULLは入れ子にできる
  - HULLには外側と内側がある
- 回路仕様：
  - HULLに接続しているユニットを回路的に接続する
    - accessibilityでアクセスが禁止されている方向へは接続されない
- 生成仕様
  - 容積が固定のHULL:
    - `M0O3C1E5 * floor((容積 + 1) * 0.05)`
      - ※ 容積は0以上の整数
  - 生成後に容積を加減可能なHULL:
    - `M0O5C2E8 * floor((容積 + 1) * 0.1)`
      - ※ 容積は0以上の整数
- 分解仕様：
  - HULLを構成する `ceil(構成Organic量 / 2)` 以上のOrganic, もしくは `ceil(構成Chemical量 / 3)` 以上のChemicalが剥ぎ取られると機能を失う
- API：
  - hits
    - そのユニットのhits算出方法は生成時に定義される。値は毎tick更新される。readonly
    - hitsはユニットの耐久値を表したものである
    - 耐久値は、ユニットがどれだけの構成要素を失っても機能を維持できるかを数値化したものである。そのため、値としてのhitsが大きいユニットの方が、同じ負荷に対して常に耐久性があるわけではない
  - accessibility
    - 生成時に定義。readonly
    - 回路を通じたアクセスが行えるかどうかを表す。以下のうちのひとつ
      - 外側から内側へのアクセスのみ可能
      - 内側から外側へのアクセスのみ可能
      - 双方向のアクセスが可能
      - アクセスはできない
  - adjacentObjectsInside
    - HULLの内側に格納されているオブジェクトの一覧
  - adjacentObjectsOutside
    - HULLの外側に"隣接"しているオブジェクトの一覧

#### ASSEMBLER

- 概要：
  - ユニットを生成・修復する
  - 資源を合成する
- 仕様：
  - ASSEMBLERは生成・修復対象
- 回路仕様：
- API：
  - hits
    - そのユニットのhits算出方法は生成時に定義される。値は毎tick更新される。readonly
    - hitsはユニットの耐久値を表したものである
    - 耐久値は、ユニットがどれだけの構成要素を失っても機能を維持できるかを数値化したものである。そのため、値としてのhitsが大きいユニットの方が、同じ負荷に対して常に耐久性があるわけではない
  - assemble(location)
  - recipe
  - adjacentObjects

#### DISASSEMBLER

#### CONNECTOR

#### COMPUTER

#### SENSOR

- 概要：
  - 遠距離の状態を計測する

#### MOVER

- 概要：
- 仕様：
  - 制約なしに常に推進力を得る / 近くに反動を利用できる質量体がある場合のみ使える / 近くの質量体に自身を固定する（これはCONNECTORで賄えるのでは）

### Synthetica Script

- Synthetica Assembler
- Synthetica C

### 祖先種

- _TBD_
